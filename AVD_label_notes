Image Annotation:
=================
- source code for Image Annotation is in the following directory:
/home/reza/work/annotation_hoiem/hoiem_annot_tool

- The annotation is done using the script
- /home/reza/work/annotation_hoiem/hoiem_annot_tool/objectLabelingScript.m
- After annotation the pixels are relabeled to have a same global labels for 86 (MS-COCO + Activision objects) using the script:
- /home/reza/work/annotation_hoiem/hoiem_annot_tool/create_global_labels.

Superpixel Generation:
======================
- source code for superpixel generation is in the following directory:
/home/reza/work/rcnn-depth/eccv14-code/gmu_superpixel_code/
- the superpixel generation is done using the following script:
- /home/reza/work/rcnn-depth/eccv14-code/gmu_superpixel_code/generateSpxlScript.m

(PS: the code is also setup in George's computer and most of the scenes were processed in his machine)


Label Propagation:
==================
- source code for Label Propagation is in the following directory:
/home/reza/work/label_props

- the labels are propagated for a particular scene using the following script:
- /home/reza/work/label_props/propagate_3dprojv7.m

- prior to running the script (parameters) are separately created by another script
/home/reza/work/label_props/preprocess_label_propagation_script.m

the parameters are as follows:
- labeled 'key-frames'
- non-labeled key-frames
- 3D point cloud per image
- rotation+translation per image (comes from the global registration using Colmap software)

It collects some of the scene-specific information from the mat file 'image_structs.mat'. Active-Vision dataset provides this
for each scene.

Notes by Yimeng
Use scene 'Home_010_1' in ~/ActiveVisionDataset as an example
To start Matlab, open terminal, go to matlab_2017
change to root user
$ matlab
1. run create_global_labels.m in ~/work/annotation_hoiem/hoiem_annot_tool folder. Change variable 'start_num' if we find inconsistency in the labels.
The script will generate another set of mat files saved in 'label_Home_010_1' folder in ~/ActiveVisionDataset/Home_010_1
If you want to fix the labels, fix the 'objects' struct. And save it through 'save(inname, 'objects')' code.
2. Copy the generated set of mat files to 'label_props/VIDEO_name
3. run the preprocess_label_propagation_script.m in work/label_props 5 times.
At each time, finish one of the 5 tasks 'select_ALL_FRAME', 'SELECT_KEY_FRAME', 'GENERATE_XYZworld', 'VISUALIZE_XYZworld', 'PRUNE_KEY_FRAME'.

When we run create_global_labels.m,
1. add the room to label to directory list imdir, indir, outdir.
2. change 'video_index', refers to the Home you are going to label.
3. change 'startnum', refers to the image you start with. 
4. To fix the mistakenly labeled object name, use the following two lines.
objects.name{iobj} = 'nature_valley_sweet_and_salty_nut_almond';
save(inname, 'objects');

Before we run preprocess_label_propagation_script.m,
1. put the avds_scene_folder, e.g. Home_006_01, under label_prop folder.
2. make sure 'final_label', 'intrinsic.mat' and 'spM' is inside.
3. Then run the 5 steps in preprocess.m script. We can skip the 4th step visualization.
 don't forget to change the video_name and v_index to refer to the scene you are processing.
4. video 007, image 0007100040301 has undecoded depth image.
Some images don't have label propagation results because their [R | T] matrix is missing from AVD dataset.
 
 propagate_3dprojv7('Home_006_1', 1, 2412)
 propagate_3dprojv7('Home_004_1', 1, 1488)
 propagate_3dprojv7('Home_007_1', 1, 402)
 propagate_3dprojv7('Home_007_1', 404, 1728)
 
 0006100174901
 0007100134601
 0004100122001
 propagate_3dprojv7('Home_004_1', 1220, 1488)
 image 0001 and 1220 result is missing from the folder Home_004_1
 
 propagate_3dprojv7('Home_006_1', 2351, 2412)
 
 propagate_3dprojv7('Home_007_1', 1345, 1728)
 
 propagate_3dprojv7('Home_010_1', 1, 1320)
 propagate_3dprojv7('Home_011_1', 1, 1548)
 propagate_3dprojv7('Home_016_1', 1, 1128)
 
 propagate_3dprojv7('Home_010_1', 1, 500)
 propagate_3dprojv7('Home_010_1', 500, 1000)
 propagate_3dprojv7('Home_010_1', 1000, 1320)
 propagate_3dprojv7('Home_010_1', 1202, 1320)
 
 propagate_3dprojv7('Home_011_1', 1, 500)
 propagate_3dprojv7('Home_011_1', 500, 1000)
 propagate_3dprojv7('Home_011_1', 1000, 1548)
 propagate_3dprojv7('Home_011_1', 1155, 1548)
 propagate_3dprojv7('Home_011_1', 691, 1000)
 
 propagate_3dprojv7('Home_016_1', 1, 500)
 propagate_3dprojv7('Home_016_1', 500, 850)
 propagate_3dprojv7('Home_016_1', 850, 1128)
 
  propagate_3dprojv7('Home_016_1', 1012, 1128)
  
  
5. Visualize the label propagation results through visPropLabelsv2.m.
First label_props/demo_output.py to generate index.html for each scene.
